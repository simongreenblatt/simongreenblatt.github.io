<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Exercises in hacking and exploitation"><title>Exercises</title>
<link rel=canonical href=https://simongreenblatt.github.io/p/exercises/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Exercises"><meta property='og:description' content="Exercises in hacking and exploitation"><meta property='og:url' content='https://simongreenblatt.github.io/p/exercises/'><meta property='og:site_name' content='Simon Greenblatt'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2024-08-28T00:00:00+00:00'><meta property='article:modified_time' content='2024-08-28T00:00:00+00:00'><meta name=twitter:title content="Exercises"><meta name=twitter:description content="Exercises in hacking and exploitation"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/avatar_hu9556519652160966276.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Simon Greenblatt</a></h1><h2 class=site-description>Commercial Security Analyst, Varonis Systems</h2></div></header><ol class=menu-social><li><a href=mailto:simongreenblatt@gmail.com target=_blank title=E-mail rel=me><svg class="icon icon-tabler icon-tabler-mail" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="2"/><polyline points="3 7 12 13 21 7"/></svg></a></li><li><a href=https://www.linkedin.com/in/simon-greenblatt target=_blank title=LinkedIn rel=me><svg class="icon icon-tabler icon-tabler-brand-linkedin" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2z"/><path d="M8 11v5"/><path d="M8 8v.01"/><path d="M12 16v-5"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li><li><a href=/p/about/resume_cyber.pdf target=_blank title=Resume rel=me><svg class="icon icon-tabler icon-tabler-file-info" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 3v4a1 1 0 001 1h4"/><path d="M17 21H7a2 2 0 01-2-2V5a2 2 0 012-2h7l5 5v11a2 2 0 01-2 2z"/><path d="M11 14h1v4h1"/><path d="M12 11h.01"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li class=current><a href=/p/exercises><svg class="icon icon-tabler icon-tabler-terminal-2" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 9l3 3-3 3"/><path d="M13 15h3"/><path d="M3 4m0 2a2 2 0 012-2h14a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2z"/></svg>
<span>Exercises</span></a></li><li><a href=/p/about><svg class="icon icon-tabler icon-tabler-user" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>Profile</span></a></li><li><a href=/p/projects><svg class="icon icon-tabler icon-tabler-file-code" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 3v4a1 1 0 001 1h4"/><path d="M17 21H7a2 2 0 01-2-2V5a2 2 0 012-2h7l5 5v11a2 2 0 01-2 2z"/><path d="M10 13l-1 2 1 2"/><path d="M14 13l1 2-1 2"/></svg>
<span>Projects</span></a></li><li><a href=/p/research><svg class="icon icon-tabler icon-tabler-eyeglass-2" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 4H6L3 14v2.5"/><path d="M16 4h2l3 10v2.5"/><line x1="10" y1="16" x2="14" y2="16"/><circle cx="17.5" cy="16.5" r="3.5"/><circle cx="6.5" cy="16.5" r="3.5"/></svg>
<span>Research</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#creating-an-exploitation>Creating an Exploitation</a></li><li><a href=#developing-shellcode>Developing Shellcode</a></li><li><a href=#participating-in-a-hackathon>Participating in a Hackathon</a></li><li><a href=#bypassing-access-controls>Bypassing Access Controls</a></li><li><a href=#hacking-a-website>Hacking a Website</a></li><li><a href=#breaking-weak-cryptography>Breaking Weak Cryptography</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/p/exercises/>Exercises</a></h2><h3 class=article-subtitle>Exercises in hacking and exploitation</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Aug 28, 2024</time></div></footer></div></header><section class=article-content><h2 id=creating-an-exploitation>Creating an Exploitation</h2><p><img src=/p/exercises/modem.jpg width=350 height=306 srcset="/p/exercises/modem_hu10275916833486532988.jpg 480w, /p/exercises/modem_hu13303879478799501806.jpg 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=114 data-flex-basis=274px></p><p>In April 2021, Tenable disclosed CVE-2021-20090, a path traversal vulnerability in the firmware of a Wi-Fi module produced by Arcadyan. This firmware is present in the HughesNet HT2000W satellite modem for which I performed a <strong>security assessment</strong>. My process involved creating a hardware and software bill of materials, reverse engineering the firmware, and turning this vulnerability into a full <strong>exploitation chain</strong>. I implemented my exploit as a Python script and a Metasploit module which reset the administrator password of the web configuration portal. My Python script has since been published on Exploit-DB.</p><p><strong>Timeline:</strong> June - August 2024<br><strong>Techniques:</strong> Path Traversal, Firmware Extraction, Reverse Engineering<br><strong>Technologies:</strong> Ghidra, Burp Suite, Wireshark, Python, Ruby<br><strong>Exploits:</strong> <a class=link href=https://github.com/simongreenblatt/HT2000W-Exploit/ target=_blank rel=noopener>GitHub</a>, <a class=link href=https://www.exploit-db.com/exploits/52073 target=_blank rel=noopener>Exploit-DB</a><br><strong>Video Demo:</strong> <a class=link href="https://www.youtube.com/watch?v=CdzE0jAhwwY" target=_blank rel=noopener>YouTube</a><br><strong>Poster:</strong> <a class=link href=modem_poster.pdf>Link</a></p><h2 id=developing-shellcode>Developing Shellcode</h2><p><img src=/p/exercises/shell.jpg width=400 height=249 srcset="/p/exercises/shell_hu16931507388776159023.jpg 480w, /p/exercises/shell_hu16885852014583877120.jpg 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=160 data-flex-basis=385px></p><p>Using disassembly and debug tools, I <strong>reverse engineered a binary</strong> that was hardened using non-executable memory and full ASLR. This binary contained both a stack-based buffer overflow and a format string vulnerability which allowed me to leak memory addresses in order to bypass ASLR. I then <strong>developed a JIT-ROP payload</strong> that hijacked the control flow of the program and initiated a ret2libc attack. The purpose of this capture-the-flag exercise was to pass the value of a hidden symbol as an argument into a function. I then successfully restored the execution of the program by cleaning up any trashed registers.</p><p><strong>Timeline:</strong> September - December 2023<br><strong>Techniques:</strong> Stack Pivoting, ret2libc, JIT-ROP<br><strong>Technologies:</strong> x86 Assembly, ROPgadget, gdb, objdump</p><h2 id=participating-in-a-hackathon>Participating in a Hackathon</h2><p><img src=/p/exercises/cyberfire.jpg width=400 height=249 srcset="/p/exercises/cyberfire_hu16102274963652999349.jpg 480w, /p/exercises/cyberfire_hu3387537523391096668.jpg 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=160 data-flex-basis=385px></p><p>I participated in the 2023 OMNI Fire training and competition. This event included two days of lab-heavy training on cybersecurity tools and topics including network archeology, host forensics, and <strong>malware analysis</strong>. The two-day competition involved solving puzzles related to password cracking, threat hunting, protocol reverse engineering, and other cybersecurity categories. I helped my team by recovering hidden files using steganographic tools and <strong>reconstructing a simulated incident</strong> from payload delivery, through persistence, to data exfiltration.</p><p><strong>Timeline:</strong> August 2023<br><strong>Techniques:</strong> File Carving, Packet Inspection, Forensic Analysis<br><strong>Technologies:</strong> Autopsy, Hashcat, Wireshark, Python, Foremost</p><h2 id=bypassing-access-controls>Bypassing Access Controls</h2><p><img src=/p/exercises/cameras.jpg width=400 height=223 srcset="/p/exercises/cameras_hu839295370368045815.jpg 480w, /p/exercises/cameras_hu3732209896003463568.jpg 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p>In this exercise I break a fictitious autograding system to steal other student&rsquo;s assignments and trick it into giving me a good grade. I use my knowledge of file permissions, <strong>setuid Linux programs</strong>, and process isolation to create exploits that take advantage of vulnerabilities I found in the source code. As an exercise in <strong>privilege escalation</strong>, I demonstrate how safelists, input sanitization, and the principle of least privilege can be used to prevent users from circumventing access controls.</p><p><strong>Timeline:</strong> March - April 2023<br><strong>Attacks:</strong> Arbitrary Code Execution, Symlink Traversal, Path Sanitization Bypass<br><strong>Technologies:</strong> Golang, Bash script, Unix</p><h2 id=hacking-a-website>Hacking a Website</h2><p><img src=/p/exercises/report.jpg width=400 height=208 srcset="/p/exercises/report_hu9535943530740113121.jpg 480w, /p/exercises/report_hu11101552533598989365.jpg 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=192 data-flex-basis=461px></p><p>I took advantage of a poorly configured website to perform unauthorized actions on its web server. An unsanitaized username field allowed me to create a <strong>SQL injection</strong> attack to bypass a password check on a login page; I used a Stored XSS attack to steal user&rsquo;s cookies that had the HttpOnly flag set to false; By noticing that the website didn&rsquo;t use CSRF tokens, I was able to perform actions on behalf of unsuspecting users who clicked a malicious link to an HTML file with a hidden POST request. My <strong>vulnerability reports</strong> detail the discovery, impact, and mitigation of these and other attacks.</p><p><strong>Timeline:</strong> February - March 2023<br><strong>Attacks:</strong> SQL Injection, Stored XSS, CSRF, Insecure Direct Object Reference<br><strong>Technologies:</strong> HTML, JavaScript, SQL, Burp Suite</p><h2 id=breaking-weak-cryptography>Breaking Weak Cryptography</h2><p><img src=/p/exercises/crypto.jpg width=400 height=230 srcset="/p/exercises/crypto_hu6761799418737955537.jpg 480w, /p/exercises/crypto_hu13703321084373982000.jpg 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=173 data-flex-basis=417px></p><p>Did you know that until 2020 Zoom meetings were encrypted using AES in ECB mode? My first target for these attacks was an encrypted database of student grades whose format and layout was known. By exploiting the weaknesses of ECB mode and using <strong>statistical correlation</strong>, I was able to learn information about student&rsquo;s grades. I also performed a brute force attack to <strong>recover the encryption key</strong> of an encryption scheme that uses a 16-bit initialization vector. Finally, I created a Python script to recover the keys of a double encryption scheme by performing a meet-in-the-middle attack on a midway ciphertext.</p><p><strong>Timeline:</strong> February 2023<br><strong>Attacks:</strong> Statistical Cryptanalysis, Meet-in-the-Middle, Brute Force<br><strong>Technologies:</strong> Python, Java</p><p>All attacks were performed in a safe and simulated environment.</p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Aug 28, 2024 00:00 UTC</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2020 -
2024 Simon Greenblatt</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.27.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>